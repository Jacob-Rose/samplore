# SamplifyPlus JUCE Migration - Action History
# Session: 2025-11-23

## Initial Setup
1. User attempting to compile JUCE project on Linux
2. Projucer was built successfully at ~/Documents/juce/cmake-build/extras/Projucer/Projucer_artefacts/Projucer

## Actions Taken

### 1. Added Linux Exporter
- File: SamplifyPlus.jucer
- Added LINUX_MAKE exporter section with all module paths pointing to /home/jakee/Documents/juce/modules
- Changed useGlobalPath="1" to useGlobalPath="0" for all modules

### 2. Fixed SortingMethod.h
- Line 16: Changed "const enum class SortingMethod" to "enum class SortingMethod"
- Reason: 'const' cannot be applied to enum class declarations

### 3. Fixed SamplifyProperties.h/.cpp
- Changed browseForDirectory() from static returning File to instance method with callback
- Added mFileChooser unique_ptr member
- Updated loadPropertiesFile() to use async pattern with lambda callbacks

### 4. Fixed PreferenceWindow.h/.cpp
- Added ChangeListener inheritance to View class
- Added mColourSelector unique_ptr and mEditingPrimaryColor flag
- Replaced CallOutBox::runModalLoop() with launchAsynchronously()
- Added changeListenerCallback() to handle color changes

### 5. Fixed SamplePlayerComponent.h/.cpp
- Added mColourSelector unique_ptr and onColourChanged() method
- Updated buttonClicked() to use async ColourSelector
- Updated changeListenerCallback() to handle ColourSelector
- Changed PopupMenu::show() to showMenuAsync()

### 6. Fixed TagExplorer.h/.cpp
- Added mAlertWindow unique_ptr member
- Replaced DialogWindow::showModalDialog() with AlertWindow::enterModalState()

### 7. Fixed TagExplorer_V2.h/.cpp
- Same changes as TagExplorer

### 8. Fixed TagTile.cpp
- Replaced PopupMenu::show() with showMenuAsync() and lambda callbacks
- Captured necessary variables (parent, tagCopy) for async callbacks

### 9. Fixed DirectoryExplorerTreeViewItem.cpp
- Replaced PopupMenu::show() with showMenuAsync()
- Captured parentItem and sampleDir for async callback

### 10. Fixed SampleTile.h/.cpp
- Added mFileChooser unique_ptr member
- Replaced PopupMenu::show() with showMenuAsync() and nested callbacks
- Replaced FileChooser::browseForFileToSave() with launchAsync()
- Replaced NativeMessageBox::showYesNoBox() with showAsync() using MessageBoxOptions

### 11. Fixed SamplifyMenuBar.h/.cpp
- Added mVolumeWindow unique_ptr member
- Replaced browseForDirectory() call to use callback pattern
- Replaced DialogWindow::showModalDialog() with AlertWindow pattern
- Replaced PreferenceWindow/InfoWindow runModalLoop() with enterModalState()

## Build Status
- All code changes complete
- Build fails due to missing system libraries:
  - ft2build.h (freetype2) - needs libfreetype6-dev
  - webkit2gtk-4.0 - needs libwebkit2gtk-4.1-dev

## Next Steps
1. Install: sudo apt install libfreetype6-dev libwebkit2gtk-4.1-dev libgtk-3-dev libasound2-dev
2. Rebuild: make -C Builds/LinuxMakefile CONFIG=Release -j4
3. Test application

## Bug Fix - Crash in DirectoryExplorerTreeViewItem
- Date: 2025-11-23
- Issue: App crashed when clicking on directory tree items
- Root cause: itemOpennessChanged() accessed mSampleDirectory without checking if valid
- Fix: Added null check and mShouldUseFile check before accessing mSampleDirectory
- File: Source/DirectoryExplorerTreeViewItem.cpp line 171

## Bug Fix - Menu Bar Not Showing on Linux
- Date: 2025-11-23
- Issue: Menu bar was not rendered on Linux
- Root cause: Main.cpp only set up menu bar for Mac and Windows, not Linux
- Fix: Changed #if conditions to use #else for Windows/Linux combined
- File: Source/Main.cpp lines 93-99, 104-109

## Bug Fix - Directories Not Showing in Tree View
- Date: 2025-11-23
- Issue: Directory tree was empty even though settings file had directories
- Root cause: DirectoryExplorer wasn't registered as ChangeListener to SampleLibrary
- Fix: Added addChangeListener(this) in constructor, removeChangeListener in destructor
- File: Source/DirectoryExplorer.cpp lines 11, 17-18
